## MySQL学习笔记

> auth : 高江涛(卓轩)

### 一、数据类型


* 数据类型简单就好
> 简单类型的操作需要更少的CPU周期；
例如：整数比字符代价更低,因为字符集的排序规则，验证规则要比整形复杂的多；所以一般情况请使用MySQL的内建数据类型。日期使用datetime,IP地址使用整形。

* 尽可能的使用最小数据类型；例如 tinyint,int,bigint 无符号的整数类型。

* 尽量避免使用null值，除非业务真的需要定义为null。
> 因为null值使得索引，索引统计，值比较变的更加的复杂。为null的列被索引时还需要多一个字节的存储。

* varchar，char 可变长度，定长.
> 当varchar类型列设置  row_format=fixed varchar类型也是定长。一般情况多余1、2个字节保存数据。根据varchar(x)长度 0-255 为1个字节。 

* 慷慨是不明智的选择
> 使用 varchar(5) 和 varchar(200) 都可以存储  hello 而且开销是一样的；但是使用更长的列会消耗更多地内存，因为MySQL会保存固定的内存块来保存内部值。尤其是使用内存进行排序的时候；使用磁盘临时表进行排序时候问题更大。

* 避免使用text类型，Memory引擎;
> 排序时候使用的内存空间或者硬盘大小很夸张的。使用内容表，还是磁盘表根据  max_heap_table_size的参数值来决定。


* 时间类型尽量使用 timestamp 数据类型
> TimeStamp 比 datetime 类型的空间效率更高的，如果使用微妙的数据类型存储，建议使用bigint存储时间戳。

* 主键定义的类型选择
> 定义主键标识符一般选择整形，无符号，子增长查询order by 都会很快；
> 避免使用varchar类型，消耗的空间比较大而且比整形查询慢。
> 避免使用字符内容为随机的字符作为主键，这个会导致新的记录分布在很大的空间内，insert,select 都会变慢。  当心ORM框架自动生成的 schema ，里面隐含了一些自动的数据类型定义，可能会存在性能问题。

* 特殊的数据内容IP地址存储
> 我们一般使用varchar(15)来存储IP地址，其实IP地址是32位的无符号整数，不是字符串。并且MySQL内置函数  INET_ATON 和 INET_NTOA 进行相互的转换。




* 表结构设计太多的列

---

* 缓存表汇总表的设计

* 计数器表的设计

---


* 加快 alter table 的速度
> MySQL 修改表结构实质是用新的结构创建一个新的表，然后将所有的数据查询出插入到新的数据表，然后删除旧的表，这个操作在数据量大的表来说简直就是一个噩耗，根本无法接受的；所以在alter table 的时候MySQL会自动锁表，禁止写入产生增量数据。
> 可以使用在一个不提供服务的机器上修改表结构，然后进行主备切换。
> 影子拷贝，用要求的结构创建一个和原表无关的新表，然后使用重命名和删除表操作来完成。
> alter table modify => alter table alter 修改默认值不会引起表重建的；只修改存储结构的frm文件。



### 二、高性能索引








### 三、解析查询执行过程
